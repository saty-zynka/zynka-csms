networks:
  default:
    name: zynka-csms
    external: true

services:
  solidstudio-vcp:
    build:
      context: ../simulator
      dockerfile: Dockerfile
    environment:
      - WS_URL=ws://gateway:9310/ws
      - CP_ID=cs001
      - PASSWORD=${CS_PASSWORD:-password}
      - ADMIN_PORT=9999
      - OCPP_VERSION=16
    ports:
      - "9999:9999"  # Admin API port
    networks:
      - default
    healthcheck:
      test: ["CMD", "node", "-e", "require('http').get('http://localhost:9999/execute', (r) => process.exit(r.statusCode === 404 ? 0 : 1)).on('error', () => process.exit(1))"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 10s
